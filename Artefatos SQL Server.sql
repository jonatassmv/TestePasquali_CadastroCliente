
CREATE TABLE [dbo].[Clientes](
	[Id] [int] IDENTITY(1,1) NOT NULL,
	[Nome] [varchar](75) NOT NULL,
	[DataNasc] [datetime] NOT NULL,
	[CPF] [varchar](11) NOT NULL,
	[RG] [varchar](9) NOT NULL
) ON [PRIMARY]
GO

CREATE PROCEDURE [dbo].[SPCLIENTEDELETE]
	@ID INT
AS
BEGIN

	BEGIN TRY
		DELETE FROM Clientes WHERE Id = @ID
	END TRY
	BEGIN CATCH
	END CATCH

END
GO

CREATE PROCEDURE [dbo].[SPCLIENTEINSERT]
	@NOME VARCHAR(75),
	@DATANASC DATETIME,
	@CPF VARCHAR(11),
	@RG VARCHAR(9)
AS
BEGIN

	DECLARE @RETORNO AS INT SET @RETORNO = 0

	BEGIN TRY
		INSERT INTO Clientes(
			NOME,
			DATANASC,
			CPF,
			RG
		) VALUES(
			@NOME,
			@DATANASC,
			@CPF,
			@RG
		)

		SET @RETORNO = @@IDENTITY
	END TRY
	BEGIN CATCH
	END CATCH

	SELECT @RETORNO AS 'InsertedID'
END
GO

CREATE PROCEDURE [dbo].[SPCLIENTELIST]
	@NOME VARCHAR(75),
	@CPF VARCHAR(11),
	@RG VARCHAR(9)
AS
BEGIN

	BEGIN TRY

		SELECT
			ID,
			NOME,
			DATANASC,
			CPF,
			RG
		FROM
			Clientes
		WHERE 
			Nome LIKE ISNULL('%%' + @NOME + '%%','%%') AND
			--DataNasc >= ISNULL(@DATANASC,'01/01/1753') AND
			CPF LIKE ISNULL('%%' + @CPF + '%%','%%') AND
			RG LIKE ISNULL('%%' + @RG + '%%','%%')

	END TRY
	BEGIN CATCH
	END CATCH

END
GO

CREATE PROCEDURE [dbo].[SPCLIENTESELECT]
	@ID INT NULL
AS
BEGIN

	BEGIN TRY

		IF @ID IS NOT NULL BEGIN
			SELECT
				Id,
				NOME,
				DATANASC,
				CPF,
				RG
			FROM
				Clientes
			WHERE Id = @ID
		END

	END TRY
	BEGIN CATCH
	END CATCH

END
GO

CREATE PROCEDURE [dbo].[SPCLIENTEUPDATE]
	@ID INT,
	@NOME VARCHAR(75),
	@DATANASC DATETIME,
	@CPF VARCHAR(11),
	@RG VARCHAR(9)
AS
BEGIN

	BEGIN TRY
		UPDATE Clientes SET
			NOME     = @NOME,  
			DATANASC = @DATANASC,
			CPF		 = @CPF,
			RG		 = @RG
		WHERE Id = @ID

	END TRY
	BEGIN CATCH
	END CATCH

END
GO